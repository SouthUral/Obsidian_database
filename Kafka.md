[[Брокеры сообщений]]

В основе системы обмена сообщениями __Kafka__ лежит секционированный, воспроизводимы журнал. Пример: 
>_у вас есть набор сообщений последовательно дописываемых в файл, когда сервис хочет прочитать сообщения из Kafka, он ищет позицию последнего прочитанного им сообщения, и с этого места читает сообщения по порядку, одновременно фиксируя свою новую позицию в журнале._

# Термины
- __Noda__ - это единица __Kafka-broker__;
- __Producer__ - это система, которая пишет сообщения в __Kafka__, внешний сервис;
- __Consumer__ - клиент, который потребляет сообщения;
- __Topic__ - это логическая единица, в него поступают сообщения одного типа;
- __Record__ - сообщение, структура сообщения:
	- Ключ
	- Значение
	- Таймстемп
- __Partition__ - топик делится на партиции

Основные сущности  __Kafka__:
 - Broker;
 - Zookeeper;
 - Message (Record);
 - Topic/Partition;
 - Producer;
 - Concumer;

Функции брокера (Kafka Broker | Kafka Server | Kafka Node):
 - Прием сообщений;
 - Хранение сообщений;
 - Выдача сообщений;



Zookeeper - это БД, она быстро работает на операции чтения и не очень быстро на операции записи.

Структура Message:
![[Pasted image 20231129105527.png]]

Topic - это стрим данных. 
- При чтения из топика данные не удаляются.
__Topic__ делится на партиции (партиция это единица парралелизации с точки зрения записи).
Партиция делится на сегменты. Сами партиции хранятся на диске.




Данные брокера хранятся в Log-файлах. У брокера в файловой системе есть папка __./logs__ в ней есть папки под каждую партицию.
![[Pasted image 20231129110446.png]]